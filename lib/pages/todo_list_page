import 'package:flutter/material.dart';
import 'package:todo_list/widgets/todo_list_item';
import 'package:todo_list/models/todo';

//arquivo exclusivo p/ colocar o código da página da lista de tarefas
class TodoListPage extends StatefulWidget {
  const TodoListPage({Key? key}) : super(key: key); //construtor

  @override
  State<TodoListPage> createState() => _TodoListPageState();
}

class _TodoListPageState extends State<TodoListPage> {
  final TextEditingController todoController = TextEditingController(); //controlador p/ pegar o texto do campo de texto

  List<Todo> todos = []; //lista da classe Todo, cada Todo é o título de uma tarefa

  @override
  Widget build(BuildContext context) {
    return SafeArea(
      child: Scaffold(
      body: Center(
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            mainAxisSize: MainAxisSize.min, //ocupa a menor altura possivel
            children: [
              Row(
                children: [
                  Expanded(
                    child: TextField(
                      controller: todoController,
                      decoration: InputDecoration(
                       border: OutlineInputBorder(),
                       labelText: 'Adicione uma tarefa',
                       hintText: 'Ex. Estudar Flutter',
                      ),
                    ),
                  ),
                  SizedBox(width: 8),
                  ElevatedButton(
                    onPressed: () {
                      String text = todoController.text; //le o texto do campo de texto
                      setState(() { //atualiza a tela
                        Todo newTodo = Todo( //cria o obj newTodo
                          title: text,
                          dateTime: DateTime.now(),
                        );
                        todos.add(newTodo); //add na lista
                      });
                      todoController.clear(); //após add a tarefa ele limpa o campo de texto
                    },
                    style: ElevatedButton.styleFrom(
                      primary: Color(0xff00d7f3), //cor personalizada, inicia com 0xff seguido da cor desejada
                      padding: EdgeInsets.all(14),
                    ),
                    child: Icon(
                      Icons.add, //icone de adicionar (botão com um +)
                     size: 30,
                    ),
                  ),
                ],
              ),
              SizedBox(height: 16),
              Flexible( //faz a lista ocupar o máximo de altura que ela pode ocupar
                child: ListView( //entra aqui depois de atualizar a tela no setState 
                  shrinkWrap: true,
                  children: [
                    for(Todo todo in todos) //passa por cada um dos obj
                      TodoListItem( //passa pro widget filho
                        todo: todo, //passa o obj por completo pra dentro do TodoListItem
                        onDelete: onDelete, //passa o obj de delete pra dentro do TodoListItem
                      ),
                  ],
                ),
              ),
              SizedBox(height: 16),
              Row(
                children: [
                  Expanded(
                    child: Text(
                    'Você possui ${todos.length} tarefas pendentes', //pega o tamanho da lista e coloca dentro do texto
                    ),
                  ),
                  SizedBox(width: 8),
                  ElevatedButton(
                    onPressed: () {},
                    style: ElevatedButton.styleFrom(
                      primary: Color(0xff00d7f3), //cor personalizada, inicia com 0xff seguido da cor desejada
                      padding: EdgeInsets.all(14),
                    ),
                    child: Text('Limpar tudo'),
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    ),
    );
  }

  void onDelete(Todo todo) { //função que recebe um todo
    setState(() { //atualiza a página e
      todos.remove(todo); //remove o todo
    });
  }
}